---
import clsx from 'clsx'
import type { HTMLAttributes } from 'astro/types'

type StackDirection = 'column' | 'row'
type StackGap = 'none' | 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl' | '3xl'
type StackAlign = 'start' | 'center' | 'end' | 'stretch'
type StackJustify = 'start' | 'center' | 'end' | 'between'
type StackWidth = 'auto' | 'full'
type StackMaxWidth = 'none' | '2xl' | '3xl' | '4xl'

interface Props extends Omit<HTMLAttributes<'div'>, 'class' | 'style'> {
  as?: keyof HTMLElementTagNameMap
  direction?: StackDirection
  directionAtSm?: StackDirection | undefined
  gap?: StackGap
  gapX?: Exclude<StackGap, 'none'> | undefined
  gapAtSm?: Exclude<StackGap, 'none'> | undefined
  align?: StackAlign
  alignAtSm?: StackAlign | undefined
  justify?: StackJustify
  justifyAtSm?: StackJustify | undefined
  wrap?: boolean
  width?: StackWidth
  widthAtSm?: StackWidth | undefined
  maxWidth?: StackMaxWidth
}

const {
  as: Component = 'div',
  direction,
  directionAtSm,
  gap,
  gapX,
  gapAtSm,
  align,
  alignAtSm,
  justify,
  justifyAtSm,
  wrap,
  width,
  widthAtSm,
  maxWidth,
  ...htmlProps
} = Astro.props

const classNames = clsx(
  'flex',
  {
    'flex-col': direction === 'column',
    'flex-row': direction === 'row',
  },
  {
    'sm:flex-col': directionAtSm === 'column',
    'sm:flex-row': directionAtSm === 'row',
  },
  {
    'gap-0': gap === 'none',
    'gap-1.5': gap === 'xs',
    'gap-2': gap === 'sm',
    'gap-4': gap === 'md',
    'gap-6': gap === 'lg',
    'gap-8': gap === 'xl',
    'gap-12': gap === '2xl',
    'gap-24': gap === '3xl',
  },
  {
    'gap-x-1.5': gapX === 'xs',
    'gap-x-2': gapX === 'sm',
    'gap-x-4': gapX === 'md',
    'gap-x-6': gapX === 'lg',
    'gap-x-8': gapX === 'xl',
    'gap-x-12': gapX === '2xl',
    'gap-x-24': gapX === '3xl',
  },
  {
    'sm:gap-1.5': gapAtSm === 'xs',
    'sm:gap-2': gapAtSm === 'sm',
    'sm:gap-4': gapAtSm === 'md',
    'sm:gap-6': gapAtSm === 'lg',
    'sm:gap-8': gapAtSm === 'xl',
    'sm:gap-12': gapAtSm === '2xl',
    'sm:gap-24': gapAtSm === '3xl',
  },
  {
    'items-start': align === 'start',
    'items-center': align === 'center',
    'items-end': align === 'end',
    'items-stretch': align === 'stretch',
  },
  {
    'sm:items-start': alignAtSm === 'start',
    'sm:items-center': alignAtSm === 'center',
    'sm:items-end': alignAtSm === 'end',
    'sm:items-stretch': alignAtSm === 'stretch',
  },
  {
    'justify-start': justify === 'start',
    'justify-center': justify === 'center',
    'justify-end': justify === 'end',
    'justify-between': justify === 'between',
  },
  {
    'sm:justify-start': justifyAtSm === 'start',
    'sm:justify-center': justifyAtSm === 'center',
    'sm:justify-end': justifyAtSm === 'end',
    'sm:justify-between': justifyAtSm === 'between',
  },
  wrap && 'flex-wrap',
  {
    'w-full': width === 'full',
    'sm:w-full': widthAtSm === 'full',
  },
  {
    'max-w-2xl': maxWidth === '2xl',
    'max-w-3xl': maxWidth === '3xl',
    'max-w-4xl': maxWidth === '4xl',
  }
)
---

<Component class={classNames} {...htmlProps}>
  <slot />
</Component>
