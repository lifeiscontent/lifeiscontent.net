---
import clsx from 'clsx'
import type { HTMLAttributes } from 'astro/types'

type TextSize = 'xs' | 'sm' | 'base' | 'lg'
type TextTone = 'default' | 'muted' | 'subtle'
type TextWeight = 'regular' | 'medium' | 'semibold'
type Tracking = 'normal' | 'wide'
type Transform = 'none' | 'uppercase'
type Clamp = 2 | 3
type Leading = 'relaxed' | 'snug'

type TextAttributes = HTMLAttributes<'p'> &
  HTMLAttributes<'span'> &
  HTMLAttributes<'div'> &
  HTMLAttributes<'time'>

interface Props extends Omit<TextAttributes, 'class' | 'style'> {
  as?: keyof HTMLElementTagNameMap
  size?: TextSize
  sizeAtSm?: TextSize
  tone?: TextTone
  weight?: TextWeight
  tracking?: Tracking
  transform?: Transform
  leading?: Leading
  clamp?: Clamp | undefined
}

const {
  as: tag = 'p',
  size = 'base',
  sizeAtSm,
  tone = 'default',
  weight = 'regular',
  tracking = 'normal',
  transform = 'none',
  leading = 'relaxed',
  clamp,
  ...htmlProps
} = Astro.props

const Component = tag

const className = clsx(
  {
    'text-xs': size === 'xs',
    'text-sm': size === 'sm',
    'text-base': size === 'base',
    'text-lg': size === 'lg',
  },
  {
    'sm:text-xs': sizeAtSm === 'xs',
    'sm:text-sm': sizeAtSm === 'sm',
    'sm:text-base': sizeAtSm === 'base',
    'sm:text-lg': sizeAtSm === 'lg',
  },
  {
    'text-neutral-900 dark:text-neutral-100': tone === 'default',
    'text-neutral-600 dark:text-neutral-300': tone === 'muted',
    'text-neutral-500 dark:text-neutral-400': tone === 'subtle',
  },
  {
    'font-normal': weight === 'regular',
    'font-medium': weight === 'medium',
    'font-semibold': weight === 'semibold',
  },
  {
    'tracking-normal': tracking === 'normal',
    'tracking-[0.4em]': tracking === 'wide',
  },
  {
    uppercase: transform === 'uppercase',
  },
  {
    'line-clamp-2': clamp === 2,
    'line-clamp-3': clamp === 3,
  },
  {
    'leading-relaxed': leading === 'relaxed',
    'leading-snug': leading === 'snug',
  }
)
---

<Component class={className} {...htmlProps}>
  <slot />
</Component>
